print("===================================="); 
// print("cd to out"); 
// cd("/home/ubuntu/dump/out");
print("going to write to current directory: " + cd()); 

print("===================================="); 
print("Setting ModelicaPath"); 
setModelicaPath("/usr/lib/omlibrary:/home/ubuntu/.openmodelica/libraries:/home/ubuntu/om/mbs/omni/thin/lib/");

print("===================================="); 
print("Loading Modelica"); 
loadModel(Modelica);

print("===================================="); 
print("Loading MbsLite"); 
loadModel(MbsLite);

getErrorString();

print("===================================="); 
print("Loading SPECIFY_MODEL_NAME"); 
loadModel(SPECIFY_MODEL_NAME);

getErrorString();

print("===================================="); 
print("Instantiating SPECIFY_MODEL_NAME"); 
instantiateModel(SPECIFY_MODEL_NAME);

getErrorString();

print("===================================="); 
print("Checking SPECIFY_MODEL_NAME"); 
checkModel(SPECIFY_MODEL_NAME);

getErrorString();

print("===================================="); 
print("");
print("");
print("");
print("Started simulating"); 
print("");
print("SPECIFY_MODEL_NAME"); 
print("");
print("at");
print("");
system("date");
print("");
print("Please find results in");
print("");
print(cd());
print("");
print("");
print("");
if not SPECIFY_DRY_RUN then
  res := simulate
    ( SPECIFY_MODEL_NAME
    , outputFormat = "csv"
    , stopTime = 1000
    , numberOfIntervals = 1000000
    , tolerance = 1e-12
    // , simflags = "-lv=LOG_LS"
    // , simflags = "-lv=LOG_DASSL_STATES"

    // , method = "ida"
    // , simflags = "-idaLS=klu"
    // , simflags = "-idaScaling"

    , simflags = "-r=res_SPECIFY_MODEL_NAME.csv -cpu -emit_protected -abortSlowSimulation"
    // , simflags = "-cpu"
    // , simflags = "-emit_protected"
    // , simflags = "--noRootFinding"
    // , simflags = "-output=..."
    // , simflags = "-abortSlowSimulation"
    // , simflags = "<-ignoreHideResult>
    // , simflags = "  Emits also variables with HideResult=true annotation.

    , simflags = "-lssMaxDensity=0.003,-lssMinSize=1000"

    // , method = "impeuler"
    );
else
  print("na samom dele net"); 
end if;

getErrorString();

